# HLP Funding Bot v2

Hyperliquid 거래소의 코인별 펀딩비를 모니터링하고 텔레그램으로 알림을 보내주는 봇입니다.

## 버전
- 현재 버전: v2.0
- 업데이트 날짜: 2024-10-30
- 업데이트 내용: 
  - 다중 사용자 지원
  - 관리자 메시지 기능 추가
  - 예약 메시지 기능 추가
  - 파일/이미지 전송 기능 추가

## 기능
- 매시 59분마다 설정된 코인의 펀딩비 자동 체크
- 실시간 가격 정보 포함
- 다중 사용자 지원
- 사용자별 개별 코인 설정
- 관리자 기능 (메시지 전송, 파일 공유 등)

## 설치 방법

1. 필수 패키지 설치:
```bash
pip install python-telegram-bot
pip install aiohttp
pip install apscheduler
```

2. 관리자 설정:
   - 텔레그램에서 `@userinfobot` 검색
   - 봇과 대화 시작하면 자동으로 ID를 알려줌
   - 받은 ID를 `base_config.py`의 `ADMIN_ID`에 입력

## 파일 구조
```
v2/
├── base_config.py       # 기본 설정 파일
├── hlp_funding_bot.py   # 메인 봇 파일
├── users.json          # 사용자 정보 저장 파일 (자동 생성)
├── schedules.json      # 예약 메시지 저장 파일 (자동 생성)
├── logs/               # 로그 디렉토리
└── README.md           # 사용 설명서
```

## 일반 사용자 명령어

- `/start` - 봇 시작 및 사용자 등록
- `/help` - 도움말 표시
- `/add [코인심볼]` - 새로운 코인 추가 (예: /add BTC)
- `/remove [코인심볼]` - 코인 제거 (예: /remove BTC)
- `/list` - 현재 모니터링 중인 코인 목록 표시
- `/check` - 즉시 펀딩비 확인

## 관리자 명령어

1. **메시지 전송**
   - `/send [USER_ID] [메시지]` - 특정 사용자에게 메시지 전송
   - `/markdown [USER_ID] [메시지]` - 서식이 있는 메시지 전송
   - 서식 예시:
     - *굵게* 또는 <b>굵게</b>
     - _기울임_ 또는 <i>기울임</i>
     - `코드` 또는 <code>코드</code>
     - [링크](url)

2. **파일/이미지 전송**
   - 이미지나 파일을 선택하고 캡션에 `/send [USER_ID]` 입력

3. **예약 메시지**
   - `/schedule [날짜] [시간] [USER_ID] [메시지]`
   - 예시: `/schedule 2024-11-01 14:30 123456789 안녕하세요`

4. **사용자 관리**
   - `/userlist` - 전체 사용자 목록 및 상태 확인
     - 사용자 ID
     - 모니터링 중인 코인 목록
     - 가입일

## 주요 기능

- 실시간 펀딩비 모니터링
- 코인별 현재 가격 표시
- 예상 APR 계산
- 자동 로그 기록
- 다중 사용자 지원
- 사용자별 개별 설정 관리
- 메시지 예약 전송
- 파일/이미지 공유

## 작동 방식

1. 신규 사용자:
   - `/start` 명령어로 자동 등록
   - 기본 코인 설정 (BTC, ETH, SOL)

2. 정기 알림:
   - 매시 59분마다 자동 체크
   - 사용자별 설정된 코인만 알림

3. 관리자 기능:
   - 개별/전체 메시지 전송
   - 파일/이미지 공유
   - 예약 메시지 설정

## 주의사항

1. 봇 실행 전 관리자 ID 설정 필수
2. 로그 파일은 10MB 단위로 로테이션
3. 존재하지 않는 코인 심볼 입력 시 오류 메시지 표시
4. 코인 심볼은 대소문자 구분 없음
5. 예약 메시지는 봇 재시작 시에도 유지

## 문제 해결

1. 봇이 응답하지 않을 경우:
   - 로그 파일 확인
   - 인터넷 연결 상태 확인
   - 봇 토큰 확인

2. API 오류:
   - 로그 파일에서 상세 오류 확인
   - 잠시 후 다시 시도

3. 메시지 전송 실패:
   - 사용자 ID 확인
   - 봇이 차단되지 않았는지 확인
   - 서식 문법 확인 (마크다운/HTML 사용 시)
